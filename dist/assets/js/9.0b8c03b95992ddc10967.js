webpackJsonp([9],{"1LyZ":function(e,t,a){"use strict";function n(e){a("4Yn3")}function r(e){a("o6aQ")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("KGGV"),o=a("HzJ8"),l=a.n(o),s=a("4YfN"),c=a.n(s),p=a("04Cm"),d=a("R2SV"),f=a("9rMa"),v={name:"changePower",props:["ctype","roleName","roleDesc"],data:function(){return{powers:"",powerName:"",powerDescribe:"",layerType:"",powerId:[],changpowerData:"",off:{layer:!1}}},components:{layerConfirm:i.a},created:function(){var e=this;Object(p.getPrivileges)().then(function(t){e.powers=t.data.list,e.powers.map(function(t,a){e.$set(e.powers[a],"isChecked",!1)}),e.$parent.hasId.map(function(t,a){e.powers.map(function(a,n){a.privilegeId==t&&e.$set(e.powers[n],"isChecked",!0)})})}).catch(function(e){return Object(d.errorDeal)(e)})},computed:c()({},Object(f.mapState)(["rolelist1"])),methods:{powerModiefy:function(e){var t=this,a=[],n=1;if("change"==e||"add"==e){if(t.powers.map(function(e,t){e.hasOwnProperty("isChecked")&&1==e.isChecked&&a.push(e.privilegeId)}),0==a.length)return layer.open({content:"请选择要添加的权限",skin:"msg",time:2,msgSkin:"error"}),!1;var r=!0,i=!1,o=void 0;try{for(var s,c=l()(t.rolelist1);!(r=(s=c.next()).done);r=!0){s.value.privilege==a.join(",")&&n++}}catch(e){i=!0,o=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw o}}}if("change"==e)t.changpowerData={privilege:a.join(","),id:t.$parent.roleId},t.off.layer=!0,t.layerType="modifyPower";else if("add"==e){var f={description:t.powerDescribe,roleName:t.powerName,privilege:a.join(",")};Object(p.addRole)(f).then(function(e){200==e.code&&layer.open({content:"新增角色成功",skin:"msg",time:2,msgSkin:"success"}),t.$parent.fgetRole(),t.close()}).catch(function(e){return Object(d.errorDeal)(e)})}else"plist"==e&&(t.$parent.ltype="change")},ctypeClass:function(){var e=this;return"add"==e.ctype||"change"==e.ctype?"m-btn-orange":"plist"==e.ctype?"m-btn-green":""},close:function(){var e=this.$parent;e.off.layer=!1,e.off.searchlist=!0,e.off.changePower=!1}}},h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("section",[a("div",{staticClass:"m-title f-fs16 f-display-f"},[a("p",{staticStyle:{flex:"1"}},["change"==e.ctype?a("span",[e._v("修改角色")]):"add"==e.ctype?a("span",[e._v("增加角色")]):a("span",[e._v("角色权限详情")])]),e._v(" "),a("p",{staticStyle:{flex:"1","text-align":"right"}},[a("a",{staticClass:"m-jumplink",on:{click:e.close}},[e._v("返回列表")])])]),e._v(" "),a("div",{staticClass:"m-content"},[a("p",[e._v("角色名称：\n                "),"plist"==e.ctype||"change"==e.ctype?a("span",{staticClass:"f-fs-16"},[e._v(e._s(e.roleName))]):e._e(),e._v(" "),"add"==e.ctype?a("input",{directives:[{name:"model",rawName:"v-model",value:e.powerName,expression:"powerName"}],staticClass:"m-input-add",attrs:{placeholder:"请输入角色名称",maxlength:10,type:"text"},domProps:{value:e.powerName},on:{input:function(t){t.target.composing||(e.powerName=t.target.value)}}}):e._e()]),e._v(" "),a("p",[e._v("角色描述：\n                "),"plist"==e.ctype||"change"==e.ctype?a("span",{staticClass:"f-fs-16"},[e._v(e._s(e.roleDesc))]):e._e(),e._v(" "),"add"==e.ctype?a("input",{directives:[{name:"model",rawName:"v-model",value:e.powerDescribe,expression:"powerDescribe"}],staticClass:"m-input-add",attrs:{placeholder:"请输入角色描述",maxlength:50,type:"text"},domProps:{value:e.powerDescribe},on:{input:function(t){t.target.composing||(e.powerDescribe=t.target.value)}}}):e._e()]),e._v(" "),a("div",["change"==e.ctype||"add"==e.ctype?a("span",[e._v("当前权限：")]):e._e(),e._v(" "),a("ul",e._l(e.powers,function(t,n){return"change"==e.ctype||"add"==e.ctype?a("li",{key:n},[a("span",{class:{"m-powerlist":n>0}},[a("el-checkbox",{model:{value:t.isChecked,callback:function(a){e.$set(t,"isChecked",a)},expression:"v.isChecked"}}),e._v(" "),a("b",{staticStyle:{"padding-left":"10px"}},[e._v(e._s(t.privilegeId))]),e._v(" "),a("b",{staticStyle:{"padding-left":"5px"}},[e._v("【"),a("label",{staticStyle:{color:"#00AA01"}},[e._v(e._s(t.privilegeName))]),e._v(" : "),a("label",[e._v(e._s(t.description))]),e._v("】")])],1)]):e._e()}))]),e._v(" "),a("div",["plist"==e.ctype?a("span",[e._v("当前权限：")]):e._e(),e._v(" "),a("ul",e._l(e.powers,function(t,n){return"plist"==e.ctype&&t.isChecked?a("li",{key:n},[t.isChecked?a("span",{class:{"m-powerlist":n>0}},[a("b",[e._v(e._s(t.privilegeId))]),e._v(" "),a("b",{staticStyle:{"padding-left":"5px"}},[e._v("【"),a("label",{staticStyle:{color:"#00AA01"}},[e._v(e._s(t.privilegeName))]),e._v(" : "),a("label",[e._v(e._s(t.description))]),e._v("】")])]):e._e()]):e._e()}))]),e._v(" "),a("p",{staticStyle:{"text-align":"center"}},[a("button",{staticClass:"m-btn",class:e.ctypeClass(),on:{click:function(t){e.powerModiefy(e.ctype)}}},["add"==e.ctype?a("span",[e._v("添加")]):(e.ctype,a("span",[e._v("修改")]))])])])]),e._v(" "),e.off.layer?a("layerConfirm",{attrs:{changpowerData:e.changpowerData,layerType:e.layerType}}):e._e()],1)},m=[],u={render:h,staticRenderFns:m},_=u,y=a("Z0/y"),g=n,b=y(v,_,!1,g,"data-v-8dfb90ae",null),w=b.exports,x={name:"powerDeploy",data:function(){return{total:"",rolelist:"",layerType:"",ltype:"",roleId:"",hasId:"",roleName:"",roleDesc:"",off:{searchlist:!0,layer:!1,changePower:!1}}},created:function(){this.fgetRole()},components:{layerconfirm:i.a,changePower:w},methods:{fgetRole:function(){var e=this;Object(p.getRoles)().then(function(t){t.data.hasOwnProperty("roles")?(e.rolelist=t.data.roles,e.total=t.data.roles.length):(e.rolelist="",e.total=0)}).catch(function(e){return Object(d.errorDeal)(e)})},cancel:function(e){var t=this;t.off.layer=!0,t.layerType="deletePower",t.roleId=e.id},getpowerlist:function(e){var t=this;t.off.layer=!1,t.off.searchlist=!1,t.off.changePower=!0,t.ltype="plist",t.roleId=e.id,t.roleName=e.roleName,t.roleDesc=e.description,t.hasId=e.privilege.split(",")},changePower:function(e){var t=this;t.off.layer=!1,t.off.searchlist=!1,t.off.changePower=!0,t.ltype="change",t.roleId=e.id,t.roleName=e.roleName,t.roleDesc=e.description,t.hasId=e.privilege.split(",")},add:function(){var e=this;e.off.layer=!1,e.off.searchlist=!1,e.off.changePower=!0,e.ltype="add",e.hasId=[]},getDateTime:function(e){return Object(d.getDateTime)(e)}}},k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[e.off.searchlist?a("section",[a("div",{staticClass:"f-fs16 m-title1 f-display-f"},[e._m(0),a("p",{staticStyle:{flex:"1","text-align":"right"}},[a("button",{staticClass:"m-btn-green",on:{click:e.add}},[e._v("添加角色")])])]),e._v(" "),a("div",{staticClass:"m-searchlist"},[a("table",[e._m(1),e._v(" "),e._l(e.rolelist,function(t,n){return a("tr",[a("td",[e._v(e._s(n+1))]),e._v(" "),a("td",[e._v(e._s(t.roleName))]),e._v(" "),a("td",[e._v(e._s(e.getDateTime(t.createTime)[6]))]),e._v(" "),a("td",[a("span",{staticClass:"roleDesc"},[e._v(e._s(t.description||"--"))])]),e._v(" "),a("td",[a("a",{staticClass:"m-jumplink powerId",on:{click:function(a){e.getpowerlist(t)}}},[e._v(e._s(t.privilege))])]),e._v(" "),a("td",[a("a",{staticStyle:{color:"#29B038","text-decoration":"underline","margin-right":"20px"},attrs:{href:"javascript:void(0)"},on:{click:function(a){e.changePower(t)}}},[e._v("修改")]),e._v(" "),a("a",{staticStyle:{color:"#DB1E1E","text-decoration":"underline"},attrs:{href:"javascript:void(0)"},on:{click:function(a){e.cancel(t)}}},[e._v("删除")])])])}),e._v(" "),0==e.rolelist.length?a("tr",[a("td",{attrs:{colspan:"6"}},[e._v("\n                        暂无数据\n                    ")])]):e._e()],2)])]):e._e(),e._v(" "),e.off.layer?a("layerconfirm",{attrs:{layerType:e.layerType}}):e._e(),e._v(" "),e.off.changePower?a("changePower",{attrs:{ctype:e.ltype,roleName:e.roleName,roleDesc:e.roleDesc}}):e._e()],1)},C=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticStyle:{flex:"1"}},[a("span",[e._v("角色列表")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("tr",[a("td",[e._v("序号")]),e._v(" "),a("td",[e._v("角色名称")]),e._v(" "),a("td",[e._v("创建时间")]),e._v(" "),a("td",[a("span",{staticClass:"roleDesc"},[e._v("角色描述")])]),e._v(" "),a("td",[a("a",{staticClass:"powerId"},[e._v("权限ID")])]),e._v(" "),a("td",[e._v("操作")])])}],D={render:k,staticRenderFns:C},I=D,N=a("Z0/y"),P=r,j=N(x,I,!1,P,"data-v-4d0061e4",null);t.default=j.exports},"4Yn3":function(e,t,a){var n=a("ftPU");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("FIqI")("01bd4b3f",n,!0,{})},"7jZz":function(e,t,a){a("vu0M"),a("aTqf"),e.exports=a("M4k0")},HzJ8:function(e,t,a){e.exports={default:a("7jZz"),__esModule:!0}},M4k0:function(e,t,a){var n=a("scub"),r=a("hoFe");e.exports=a("lNjp").getIterator=function(e){var t=r(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},Q5JC:function(e,t,a){t=e.exports=a("UTlt")(!1),t.push([e.i,"\n.m-title1[data-v-4d0061e4]{padding: 20px 40px;\n}\n/* .m-title1 button{width: 90px;height: 25px;border-radius: 4px;outline: none;border: 1px solid #00AA01;background: #00AA01;color: #fff} */\n.m-searchlist[data-v-4d0061e4]{width: 98%;margin: 0 auto\n}\n.m-searchlist table[data-v-4d0061e4]{width: 100%;text-align: center;border-collapse: collapse;border: 1px solid #eee;\n}\n.m-searchlist table tr[data-v-4d0061e4]{height: 40px;\n}\n.m-searchlist table tr[data-v-4d0061e4]:not(:last-child){border-bottom: 1px solid #eee\n}\n.m-searchlist table tr[data-v-4d0061e4]:nth-child(odd){background: #fafbfd;\n}\n.m-searchlist table tr[data-v-4d0061e4]:nth-child(even){background: #FFF\n}\n.m-searchlist table tr .powerId[data-v-4d0061e4]{display: inline-block;max-width: 200px;overflow: hidden;text-overflow: ellipsis\n}\n.m-searchlist table tr .roleDesc[data-v-4d0061e4]{display: inline-block;max-width: 200px;\n}\n",""])},ftPU:function(e,t,a){t=e.exports=a("UTlt")(!1),t.push([e.i,"\n.m-content p[data-v-8dfb90ae], .m-content div[data-v-8dfb90ae]{width: 92%;margin: 0 auto\n}\n.m-content p[data-v-8dfb90ae]{margin-bottom: 10px;\n}\n.m-content div[data-v-8dfb90ae]{display: -webkit-box;display: -ms-flexbox;display: flex;\n}\n.m-content div span[data-v-8dfb90ae]{-webkit-box-flex: 1;-ms-flex: 1;flex: 1;min-width: 74px;\n}\n.m-content div ul[data-v-8dfb90ae]{-webkit-box-flex: 17;-ms-flex: 17;flex: 17;\n}\n.m-content ul li[data-v-8dfb90ae]{margin-bottom: 10px;\n}\n.m-input-add[data-v-8dfb90ae]{height: 30px;border: 1px solid #e2e2e2;width: 500px;padding-left: 15px;\n}\r\n",""])},o6aQ:function(e,t,a){var n=a("Q5JC");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("FIqI")("671f1ec8",n,!0,{})}});